<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Associations and Relationships | WBS DBA: Introduction to Quantitative Analysis</title>
  <meta name="description" content="This book contains the examples and notes for the WBS DBA Quant Methods Course. It is based on the Bookdown Demo written by Hui. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Associations and Relationships | WBS DBA: Introduction to Quantitative Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This book contains the examples and notes for the WBS DBA Quant Methods Course. It is based on the Bookdown Demo written by Hui. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Associations and Relationships | WBS DBA: Introduction to Quantitative Analysis" />
  
  <meta name="twitter:description" content="This book contains the examples and notes for the WBS DBA Quant Methods Course. It is based on the Bookdown Demo written by Hui. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Professor Nick Lee" />


<meta name="date" content="2024-01-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="uncertainty.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">WBS DBA Quantitative Methods</li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction and Orientation</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Describing the World With Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#box-plots"><i class="fa fa-check"></i><b>2.1</b> Box Plots</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#violin-plots"><i class="fa fa-check"></i><b>2.2</b> Violin Plots</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#describing-variables-and-distributions"><i class="fa fa-check"></i><b>2.3</b> Describing Variables and Distributions</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#transformations"><i class="fa fa-check"></i><b>2.4</b> Transformations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="assoc_rel.html"><a href="assoc_rel.html"><i class="fa fa-check"></i><b>3</b> Associations and Relationships</a>
<ul>
<li class="chapter" data-level="3.1" data-path="assoc_rel.html"><a href="assoc_rel.html#correlations-and-associations"><i class="fa fa-check"></i><b>3.1</b> Correlations and Associations</a></li>
<li class="chapter" data-level="3.2" data-path="assoc_rel.html"><a href="assoc_rel.html#regression"><i class="fa fa-check"></i><b>3.2</b> Regression</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="assoc_rel.html"><a href="assoc_rel.html#figure-5.1-page-124-linear-regression-of-sons-on-fathers-heights"><i class="fa fa-check"></i><b>3.2.1</b> Figure 5.1 (page 124) Linear regression of sons’ on fathers’ heights</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="assoc_rel.html"><a href="assoc_rel.html#multiple-regression"><i class="fa fa-check"></i><b>3.3</b> Multiple Regression</a></li>
<li class="chapter" data-level="3.4" data-path="assoc_rel.html"><a href="assoc_rel.html#visualizing-multiple-regression"><i class="fa fa-check"></i><b>3.4</b> Visualizing Multiple Regression</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="uncertainty.html"><a href="uncertainty.html"><i class="fa fa-check"></i><b>4</b> Understanging Uncertainty</a>
<ul>
<li class="chapter" data-level="4.1" data-path="uncertainty.html"><a href="uncertainty.html#back-to-slides"><i class="fa fa-check"></i><b>4.1</b> Back to slides…</a></li>
<li class="chapter" data-level="4.2" data-path="uncertainty.html"><a href="uncertainty.html#back-to-slides-1"><i class="fa fa-check"></i><b>4.2</b> Back to slides…</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i><b>5</b> Introduction to Bootstrapping</a>
<ul>
<li class="chapter" data-level="5.1" data-path="bootstrap.html"><a href="bootstrap.html#bootstrapping-our-previous-samples"><i class="fa fa-check"></i><b>5.1</b> Bootstrapping our Previous Samples</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="bootstrap.html"><a href="bootstrap.html#so-lets-go-back-to-the-slides.."><i class="fa fa-check"></i><b>5.1.1</b> so let’s go back to the slides…..</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bootstrap.html"><a href="bootstrap.html#bootstrapping-other-stuff"><i class="fa fa-check"></i><b>5.2</b> Bootstrapping Other Stuff…</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="bootstrap.html"><a href="bootstrap.html#correlations"><i class="fa fa-check"></i><b>5.2.1</b> Correlations</a></li>
<li class="chapter" data-level="5.2.2" data-path="bootstrap.html"><a href="bootstrap.html#back-to-the-slides"><i class="fa fa-check"></i><b>5.2.2</b> Back to the slides…</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="bootstrap.html"><a href="bootstrap.html#t-tests-for-means"><i class="fa fa-check"></i><b>5.3</b> T-Tests for Means</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="bootstrap.html"><a href="bootstrap.html#back-to-the-slides-1"><i class="fa fa-check"></i><b>5.3.1</b> Back to the slides…</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>6</b> Introduction to Probability</a>
<ul>
<li class="chapter" data-level="6.1" data-path="probability.html"><a href="probability.html#simulating-coin-flips"><i class="fa fa-check"></i><b>6.1</b> Simulating Coin Flips</a></li>
<li class="chapter" data-level="6.2" data-path="probability.html"><a href="probability.html#premier-league-goals-and-the-poisson-distribution"><i class="fa fa-check"></i><b>6.2</b> Premier League Goals and the Poisson Distribution</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>7</b> Introduction to Statistics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="statistics.html"><a href="statistics.html#the-law-of-large-numbers"><i class="fa fa-check"></i><b>7.1</b> The Law of Large Numbers</a></li>
<li class="chapter" data-level="7.2" data-path="statistics.html"><a href="statistics.html#the-distribution-of-sample-means-and-the-central-limit-theorem"><i class="fa fa-check"></i><b>7.2</b> The Distribution of Sample Means, and the Central Limit Theorem</a></li>
<li class="chapter" data-level="7.3" data-path="statistics.html"><a href="statistics.html#rate-of-change-in-football-goals-per-season"><i class="fa fa-check"></i><b>7.3</b> Rate of Change in Football Goals per Season</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ANOVA.html"><a href="ANOVA.html"><i class="fa fa-check"></i><b>8</b> ANOVA and Issues with Significance</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ANOVA.html"><a href="ANOVA.html#rate-of-change-in-football-goals-per-season---bonferroni-correction"><i class="fa fa-check"></i><b>8.1</b> Rate of Change in Football Goals per Season - Bonferroni Correction?</a></li>
<li class="chapter" data-level="8.2" data-path="ANOVA.html"><a href="ANOVA.html#statistical-power"><i class="fa fa-check"></i><b>8.2</b> Statistical Power</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="H-testing.html"><a href="H-testing.html"><i class="fa fa-check"></i><b>9</b> Classical Statistical Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="9.1" data-path="H-testing.html"><a href="H-testing.html#premier-league-goals-and-the-poisson-distribution-1"><i class="fa fa-check"></i><b>9.1</b> Premier League Goals and the Poisson Distribution</a></li>
<li class="chapter" data-level="9.2" data-path="H-testing.html"><a href="H-testing.html#correlation-significance-tests"><i class="fa fa-check"></i><b>9.2</b> Correlation Significance Tests</a></li>
<li class="chapter" data-level="9.3" data-path="H-testing.html"><a href="H-testing.html#regression-significance-tests"><i class="fa fa-check"></i><b>9.3</b> Regression Significance Tests</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">WBS DBA: Introduction to Quantitative Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="assoc_rel" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Associations and Relationships<a href="assoc_rel.html#assoc_rel" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="correlations-and-associations" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Correlations and Associations<a href="assoc_rel.html#correlations-and-associations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, let’s look at the basic concepts of correlation, using some more data from the World Happiness Report, and GDP from the World Bank, all put together by Our World in Data.</p>
<p>Remember, you will need to point the program to where the files are on YOUR computer.</p>
<p>Just double check the data by describing it. We’ve got 249 countries, with population, GDP per capita, and Happiness. There’s a fair bit of missing data, but that’s ok, as long as we are aware of it.</p>
<pre><code>##           vars   n        mean           sd     median     trimmed        mad
## Country*     1 249      125.00        72.02     125.00      125.00      91.92
## Happiness    2 153        5.49         1.12       5.53        5.52       1.16
## GDPpc        3 197    20463.88     20717.34   12655.00    17037.01   13338.95
## Pop          4 242 59178643.60 331869505.09 5596196.00 12318073.38 8185922.38
##             min          max        range  skew kurtosis          se
## Country*    1.0 2.490000e+02 2.480000e+02  0.00    -1.21        4.56
## Happiness   2.4 7.820000e+00 5.420000e+00 -0.26    -0.38        0.09
## GDPpc     731.0 1.125570e+05 1.118260e+05  1.58     2.55     1476.05
## Pop       809.0 4.663087e+09 4.663086e+09 11.65   152.44 21333379.77</code></pre>
<p>Let’s run a basic scatterplot and see what happens.</p>
<p><img src="DBA_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>Interpretation, there’s seemingly an association here. As one variable increases, the other does too.</p>
<p>Interestingly, I have chosen to put Happiness on the x-axis, which <em>implies</em> that the driver of GDP is happiness, whereas if you look at the media articles that are regularly written on this kind of topic, it is usually done the other way round, <em>implying</em> that the driver of happiness is GDP.</p>
<p>Nevertheless, while that’s an interesting little aside which might be worth thinking about some more, it’s important that you do <strong>NOT</strong> draw any causal conclusion from this very basic scatterplot, since there are many other things which could be going on. For example, there could be a spurious relationship - what could cause <em>both</em> happiness and GDPpc to increase?</p>
<p>Ideas? could it simply be ‘economic development of the country’, or ‘political stability’? Or something else?</p>
<p>Either way, let’s flip this around to more closely resemble figures that often appear using this (and similar) data in the media:</p>
<p><img src="DBA_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>There we go, looks very like the figure on the slide from the Economist.</p>
<p>But this association also looks kind of <em>nonlinear</em> to me. There are multiple ways to look at this:</p>
<ol style="list-style-type: decimal">
<li>there may be two groups of country, low and high income, and different linear associations within those groups.</li>
<li>It could be a nonlinear relationship? In fact, you could check this out by <em>transforming</em> GDPpc. Here, I might judge that a log transform might work…let’s have a go..</li>
</ol>
<p>Check it worked…</p>
<pre><code>##           vars   n        mean           sd     median     trimmed        mad
## Country*     1 249      125.00        72.02     125.00      125.00      91.92
## Happiness    2 153        5.49         1.12       5.53        5.52       1.16
## GDPpc        3 197    20463.88     20717.34   12655.00    17037.01   13338.95
## Pop          4 242 59178643.60 331869505.09 5596196.00 12318073.38 8185922.38
## GDPpc_log    5 197        9.38         1.14       9.45        9.41       1.33
##              min          max        range  skew kurtosis          se
## Country*    1.00 2.490000e+02 2.480000e+02  0.00    -1.21        4.56
## Happiness   2.40 7.820000e+00 5.420000e+00 -0.26    -0.38        0.09
## GDPpc     731.00 1.125570e+05 1.118260e+05  1.58     2.55     1476.05
## Pop       809.00 4.663087e+09 4.663086e+09 11.65   152.44 21333379.77
## GDPpc_log   6.59 1.163000e+01 5.040000e+00 -0.25    -0.79        0.08</code></pre>
<p>Let’s rerun the plot…</p>
<p><img src="DBA_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>That’s kind of cool.</p>
<p>Now, what we could do is look at the <em>correlations</em> for a slightly different way of interpreting the information.</p>
<p>Let’s pop back to the slide deck…</p>
<p>…</p>
<p>With that in mind, let’s take a quick look at the correlations for these variables.</p>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  Happy$Happiness and Happy$GDPpc
## t = 13.502, df = 146, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.6636288 0.8092331
## sample estimates:
##      cor 
## 0.745184</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  Happy$Happiness and Happy$GDPpc_log
## t = 15.916, df = 146, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.7287785 0.8487456
## sample estimates:
##       cor 
## 0.7964703</code></pre>
<p>We can see that the association is stronger (the correlation is higher) for the log GDPpc variable, although to be honest, it is not a very big difference in this data, compared to other data sets discussed in the media. Interesting in itself (note we are using 2020 data, so maybe the pandemic has something to do with it?)</p>
</div>
<div id="regression" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Regression<a href="assoc_rel.html#regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can add a regression line to this scatterplot, for some extra information over the correlation</p>
<p><img src="DBA_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p><img src="DBA_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p>I might also decide to do this with the log GDPpc to see what happens.</p>
<p><img src="DBA_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p><img src="DBA_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>So, this is an improvement, but not by that much in my view. That said, it’s clear that the line is a bit more accurate (the errors are lower which can be seen by the narrower shaded regions)</p>
<p>Either way, the regression line adds a layer of information on to the correlation, which allows us to predict y from x.</p>
<p>How so? Well, let’s add the regression equation to the chart to see:</p>
<p><img src="DBA_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>This adds an <em>intercept</em>, and with that plus the coefficient we have all we need to plot a straight line, which we can <em>extrapolate</em> to higher values of GDPpc (although remember this is the logged GDP variable) and predict what the happiness scores would be.</p>
<p>This is obviously viable to the extent we can justify the relationship, and also within the parameters of our variables, and how confident we are that the relationship is consistent at all levels of the variables.</p>
<p>Let’s pop back to the slide deck again for a second…..</p>
<p>We can also use Spiegelhalter’s code to replicate his Figure 5.1 for our slide deck, and spend some time talking about it</p>
<pre><code>##     Family              Father          Mother         Gender         
##  Length:898         Min.   :62.00   Min.   :58.00   Length:898        
##  Class :character   1st Qu.:68.00   1st Qu.:63.00   Class :character  
##  Mode  :character   Median :69.00   Median :64.00   Mode  :character  
##                     Mean   :69.23   Mean   :64.08                     
##                     3rd Qu.:71.00   3rd Qu.:65.50                     
##                     Max.   :78.50   Max.   :70.50                     
##      Height           Kids       
##  Min.   :56.00   Min.   : 1.000  
##  1st Qu.:64.00   1st Qu.: 4.000  
##  Median :66.50   Median : 6.000  
##  Mean   :66.76   Mean   : 6.136  
##  3rd Qu.:69.70   3rd Qu.: 8.000  
##  Max.   :79.00   Max.   :15.000</code></pre>
<pre><code>## [1] 197</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   62.00   68.00   69.50   69.35   71.00   78.50</code></pre>
<pre><code>## [1] 2.622034</code></pre>
<pre><code>## [1] 197</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   58.00   62.70   64.00   63.98   65.50   70.50</code></pre>
<pre><code>## [1] 2.355607</code></pre>
<pre><code>## [1] 465</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   60.00   67.50   69.20   69.23   71.00   79.00</code></pre>
<pre><code>## [1] 2.631594</code></pre>
<pre><code>## [1] 433</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   56.00   62.50   64.00   64.11   65.50   70.50</code></pre>
<pre><code>## [1] 2.37032</code></pre>
<div id="figure-5.1-page-124-linear-regression-of-sons-on-fathers-heights" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Figure 5.1 (page 124) Linear regression of sons’ on fathers’ heights<a href="assoc_rel.html#figure-5.1-page-124-linear-regression-of-sons-on-fathers-heights" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>## 
## Call:
## lm(formula = Son ~ FatherS)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.3774 -1.4968  0.0181  1.6375  9.3987 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 38.25891    3.38663   11.30   &lt;2e-16 ***
## FatherS      0.44775    0.04894    9.15   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.424 on 463 degrees of freedom
## Multiple R-squared:  0.1531, Adjusted R-squared:  0.1513 
## F-statistic: 83.72 on 1 and 463 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><img src="DBA_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  FatherS and Son
## t = 9.1498, df = 463, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.3114667 0.4656805
## sample estimates:
##       cor 
## 0.3913174</code></pre>
<p><img src="DBA_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<p>Figure 5.1 Scatter of heights of 465 fathers and sons from Galton’s data (many fathers are repeated since they have multiple sons). A jitter has been added to separate the points, and the diagonal dashed line represents exact equality between son and father’s heights. The solid line is the standard ‘best-fit’ line. Each point gives rise to a ‘residual’ (dashed line), which is the size of the error were we to use the line to predict a son’s height from his father’s.</p>
</div>
</div>
<div id="multiple-regression" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Multiple Regression<a href="assoc_rel.html#multiple-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here, we will use a simple three-variable set of simulated data, which represents rates of smoking, rates of cycling, and heart disease incidence. This data is available from: <a href="https://www.scribbr.com/statistics/linear-regression-in-r/" class="uri">https://www.scribbr.com/statistics/linear-regression-in-r/</a></p>
<pre><code>##               vars   n   mean     sd median trimmed    mad  min    max  range
## ...1             1 498 249.50 143.90 249.50  249.50 184.58 1.00 498.00 497.00
## biking           2 498  37.79  21.48  35.82   37.71  27.51 1.12  74.91  73.79
## smoking          3 498  15.44   8.29  15.81   15.47  10.86 0.53  29.95  29.42
## heart.disease    4 498  10.17   4.57  10.39   10.18   5.42 0.55  20.45  19.90
##                skew kurtosis   se
## ...1           0.00    -1.21 6.45
## biking         0.07    -1.22 0.96
## smoking       -0.04    -1.12 0.37
## heart.disease -0.03    -0.93 0.20</code></pre>
<p><img src="DBA_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<p><img src="DBA_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p><img src="DBA_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<p>OK, so these are <em>simple</em> regression lines, with bivariate scatterplots. What I mean, is the effect of biking on heart disease does not take account of the effect of smoking on heart disease. What we need to do is run a model which takes account of <em>both</em> the predictors.</p>
<p>Let’s pop back to the slides for a second…</p>
<p>Now we can run the Multiple Regression Model</p>
<pre><code>## 
## Call:
## lm(formula = heart.disease ~ biking + smoking, data = Heart)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.1789 -0.4463  0.0362  0.4422  1.9331 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 14.984658   0.080137  186.99   &lt;2e-16 ***
## biking      -0.200133   0.001366 -146.53   &lt;2e-16 ***
## smoking      0.178334   0.003539   50.39   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.654 on 495 degrees of freedom
## Multiple R-squared:  0.9796, Adjusted R-squared:  0.9795 
## F-statistic: 1.19e+04 on 2 and 495 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>We can interpret these results just as we did the earlier simple regression results.</p>
<p>A 1 unit increase in biking will on average lead to a 0.2 unit decrease in heart disease A 1 unit increase in smoking will on average lead to a 0.17 unit increase in heart disease.</p>
<p>Of course, what these ‘units’ refer to depends on what you have measured them with of course. But, the unarguable interpretation is that the effect is strong.</p>
<p>However, because the scales of the variables are different, its not really possible to compare the sizes of the effects. So to some extent we don’t know which of the two variables has the ‘bigger’ effect here, relatively at least.</p>
<p>To do that, we need to standardize the coeffiecients, and to do that in R, we need to create a new set of standardized data, and run the model on that, as follows:</p>
<pre><code>##               vars   n mean sd median trimmed  mad   min  max range  skew
## ...1             1 498    0  1   0.00       0 1.28 -1.73 1.73  3.45  0.00
## biking           2 498    0  1  -0.09       0 1.28 -1.71 1.73  3.43  0.07
## smoking          3 498    0  1   0.05       0 1.31 -1.80 1.75  3.55 -0.04
## heart.disease    4 498    0  1   0.05       0 1.19 -2.10 2.25  4.35 -0.03
##               kurtosis   se
## ...1             -1.21 0.04
## biking           -1.22 0.04
## smoking          -1.12 0.04
## heart.disease    -0.93 0.04</code></pre>
<pre><code>## 
## Call:
## lm(formula = heart.disease ~ biking + smoking, data = std_Heart)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.47658 -0.09762  0.00792  0.09671  0.42283 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -6.119e-17  6.410e-03    0.00        1    
## biking      -9.403e-01  6.418e-03 -146.53   &lt;2e-16 ***
## smoking      3.234e-01  6.418e-03   50.39   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1431 on 495 degrees of freedom
## Multiple R-squared:  0.9796, Adjusted R-squared:  0.9795 
## F-statistic: 1.19e+04 on 2 and 495 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>You can see the things that have changes are the ‘Estimates’, which are now standardized.</p>
<p>In decimal, they are -0.94 for biking and 0.32 for Smoking.</p>
<p>The correct interpretation of these standardized effects is that for every 1SD increase in biking, you expect a 0.94SD decrease in heart disease, and for every 1SD increase in smoking, you would expect a 0.32 increase in heard disease.</p>
<p>So, we can see that actually smoking has a much higher relative effect on heart disease than smoking (although in the opposite direction). However, this assumes that both the two IVs have similar standard deviations, and distributions. Which, we didn’t check.</p>
</div>
<div id="visualizing-multiple-regression" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Visualizing Multiple Regression<a href="assoc_rel.html#visualizing-multiple-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are loads of different ways to visualize multiple regression. It’s not trivial, because we have more than two variables, so we can’t use the techniques we used already.</p>
<p>Some people like to use 3D-style plots, which look cool, but are not always easy to interpret, and take quite a lot of extra work, for what I would say is not that much payoff (if any).</p>
<p>In this case, we can use a pretty simple visualization, where we could plot the relationship of biking to heart disease at different levels of smoking.</p>
<p>This would be a quite typical way to do things if we thought the relationship between biking and heart disease changed according to the level of smoking, in which case it would be a moderator. Here, it doesn’t really work that way, but it’s a cool visualization regardless. It does require some data prep, but not that much, and I took the basic idea from the website where I sourced the data: <a href="https://www.scribbr.com/statistics/linear-regression-in-r/" class="uri">https://www.scribbr.com/statistics/linear-regression-in-r/</a></p>
<p><img src="DBA_files/figure-html/unnamed-chunk-57-1.png" width="672" /><img src="DBA_files/figure-html/unnamed-chunk-57-2.png" width="672" /></p>
<p>Here, we can see that the effect of smoking is really just to raise the likelihood of heart disease, however much biking you do.</p>
<p>So, for a given person who bikes a given amount, if they smoke more they will have a higher risk than a person who bikes the same amount but smokes less.</p>
<p>But, for a given smoker, the more they bike, the lower their risk of heart disease, to the extent that if a heavy smoker bikes enough, their actual risk of heart disease could even be lower than a non-smoker who does not bike at all.</p>
<p>Don’t forget, this is not real data, but the point stands.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="uncertainty.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/02-assoc_rel.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["DBA.pdf", "DBA.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
